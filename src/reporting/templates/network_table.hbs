<div class="table-responsive">
    <table class="table table-sm table-striped">
        <thead class="table-dark">
            <tr>
                <th>Timestamp</th>
                <th>PID</th>
                <th>Activity</th>
                <th>Protocol</th>
                <th>Source</th>
                <th>Destination</th>
                <th>Data Size</th>
                <th>Direction</th>
            </tr>
        </thead>
        <tbody>
            {{#each network_activities}}
            <tr>
                <td><small>{{format_timestamp timestamp}}</small></td>
                <td><code>{{pid}}</code></td>
                <td>
                    <span class="badge bg-{{#eq activity_type "Connection"}}primary{{else}}{{#eq activity_type "DataTransfer"}}success{{else}}{{#eq activity_type "DnsQuery"}}info{{else}}secondary{{/eq}}{{/eq}}{{/eq}}">
                        {{activity_type}}
                    </span>
                </td>
                <td>
                    {{#if protocol}}
                    <code>{{protocol}}</code>
                    {{else}}
                    <span class="text-muted">N/A</span>
                    {{/if}}
                </td>
                <td>
                    {{#if source}}
                    <code class="text-break">{{source}}</code>
                    {{else}}
                    <span class="text-muted">N/A</span>
                    {{/if}}
                </td>
                <td>
                    <code class="text-break">{{destination}}</code>
                    {{#if (not (or destination.ip.is_loopback destination.ip.is_private))}}
                    <i class="fas fa-external-link-alt text-warning ms-1" title="External IP"></i>
                    {{/if}}
                </td>
                <td>
                    {{#if data_size}}
                    {{format_bytes data_size}}
                    {{else}}
                    <span class="text-muted">N/A</span>
                    {{/if}}
                </td>
                <td>
                    {{#if direction}}
                    <span class="badge bg-{{#eq direction "Inbound"}}success{{else}}primary{{/eq}}">
                        {{direction}}
                    </span>
                    {{else}}
                    <span class="text-muted">N/A</span>
                    {{/if}}
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>

{{#unless network_activities}}
<div class="text-center text-muted py-4">
    <i class="fas fa-network-wired fa-2x mb-2"></i>
    <p>No network activities captured</p>
</div>
{{/unless}}